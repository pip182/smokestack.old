{% extends "inventory/inventory_base.html" %}
{% load crispy_forms_tags %}

{% block inner %}
<div id="inventory-app" class="mt-5" v-cloak>
  <div v-if="loaded">
    <b-container fluid >
      <b-row>

        <b-col lg="6" class="my-1">
          <b-form-group label="Filter" label-cols-sm="3" label-align-sm="right" label-size="sm" label-for="filterInput"
            class="mb-0">
            <b-input-group size="sm">
              <b-form-input v-model="filter" type="search" id="filterInput" placeholder="Type to Search"></b-form-input>
              <b-input-group-append>
                <b-button :disabled="!filter" @click="filter = ''">Clear</b-button>
              </b-input-group-append>
            </b-input-group>
          </b-form-group>
        </b-col>

        <b-col lg="6" class="my-1">
          <b-form-group label="Filter On" label-cols-sm="3" label-align-sm="right" label-size="sm"
            description="Leave all unchecked to filter on all data" class="mb-0">
            <b-form-checkbox-group v-model="filterOn" class="mt-1">
              <b-form-checkbox value="name">Name</b-form-checkbox>
              <b-form-checkbox value="vendor">Vendor</b-form-checkbox>
              <b-form-checkbox value="isActive">Active</b-form-checkbox>
            </b-form-checkbox-group>
          </b-form-group>
        </b-col>

        <b-col sm="5" md="6" class="my-1">
          <b-form-group label="Per page" label-cols-sm="6" label-cols-md="4" label-cols-lg="3" label-align-sm="right"
            label-size="sm" label-for="perPageSelect" class="mb-0">
            <b-form-select v-model="perPage" id="perPageSelect" size="sm" :options="pageOptions"></b-form-select>
          </b-form-group>
        </b-col>

        <b-col sm="7" md="6" class="my-1">
          <b-pagination v-model="currentPage" :total-rows="totalRows" :per-page="perPage" align="fill" size="sm"
            class="my-0"></b-pagination>
        </b-col>
      </b-row>

      <b-row>
        <b-col>

        </b-col>
      </b-row>

      <!-- Main table element -->
      <b-table show-empty small stacked="md" :items="items" :fields="fields" :current-page="currentPage"
        :per-page="perPage" :filter="filter" :filter-included-fields="filterOn" :sort-by.sync="sortBy"
        :sort-desc.sync="sortDesc" :sort-direction="sortDirection" @filtered="onFiltered"
        @row-hovered="rowHovered">
        <template v-slot:cell(name)="row">
          [[ row.item.name ]]
        </template>

        <template v-slot:cell(actions)="row">
          <b-button size="sm" @click="info(row.item, row.index, $event.target)" class="mr-1">
            Edit Details
          </b-button>
          <b-button size="sm" @click="row.toggleDetails">
            [[ row.detailsShowing ? 'Hide' : 'Show' ]] Notes
          </b-button>
        </template>

        <template v-slot:row-details="row">
          <b-card>
            <ul class="details">
              <li v-for="(value, key) in row.item" :key="key"><code>[[ key ]]: [[ value ]]</code></li>
            </ul>
          </b-card>
        </template>
      </b-table>

      <!-- Info modal (NOTE: this has to be set to static for summernote to work) -->
      <b-modal :id="itemEditModal.id" :title="itemEditModal.title" scrollable size="lg"
                button-size="lg" ok-title="Update" static
                @hide="resetitemEditModal" @ok="itemUpdate">
        {% include 'forms/item_edit_form.html' %}
      </b-modal>
    </b-container>
  </div>
</div>
{% endblock inner %}
